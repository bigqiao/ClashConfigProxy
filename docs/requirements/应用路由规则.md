# åº”ç”¨è·¯ç”±è§„åˆ™

## åŠŸèƒ½ç›®æ ‡

åœ¨èšåˆåçš„ Clash é…ç½®ä¸­ï¼Œæ”¯æŒæŒ‰åº”ç”¨/æœåŠ¡ç»´åº¦ç‹¬ç«‹æ§åˆ¶è·¯ç”±ã€‚ç”¨æˆ·å¯ä»¥ä»ç¤¾åŒºè§„åˆ™é›†ï¼ˆblackmatrix7/ios_rule_scriptï¼‰ä¸­å‹¾é€‰éœ€è¦çš„åº”ç”¨ï¼Œæ¯ä¸ªåº”ç”¨å½’å±ä¸€ä¸ªä»£ç†ç»„åˆ†ç±»ï¼Œåœ¨ Clash å®¢æˆ·ç«¯ä¸­æŒ‰åˆ†ç±»åˆ‡æ¢è·¯ç”±ã€‚

## æ•°æ®æ¥æº

- è§„åˆ™é›†ä»“åº“ï¼š[blackmatrix7/ios_rule_script](https://github.com/blackmatrix7/ios_rule_script)
- è·¯å¾„ï¼š`rule/Clash/{AppName}/{AppName}.yaml`
- æ ¼å¼ï¼šclassical behaviorï¼Œpayload å†…å« DOMAIN-SUFFIX / DOMAIN-KEYWORD / IP-CIDR ç­‰
- æ›´æ–°ç­–ç•¥ï¼šåç«¯æ¯æ—¥å®šæ—¶æ‹‰å–åº”ç”¨åˆ—è¡¨ï¼Œç¼“å­˜åˆ°æœ¬åœ°

## é¢„å®šä¹‰ä»£ç†ç»„åˆ†ç±»

| ä»£ç†ç»„å | è¯´æ˜ |
|----------|------|
| ğŸ¬ æµåª’ä½“ | YouTube, Netflix, Disney+, Spotify, Bilibili ç­‰ |
| ğŸ’¬ ç¤¾äº¤é€šè®¯ | Telegram, WhatsApp, Discord, Twitter/X, Line ç­‰ |
| ğŸ¤– AI æœåŠ¡ | OpenAI, Claude, Gemini, Copilot ç­‰ |
| ğŸ® æ¸¸æˆ | Steam, Epic, PlayStation, Xbox ç­‰ |
| ğŸ›  å¼€å‘è€… | GitHub, GitLab, Docker, StackOverflow ç­‰ |
| ğŸ Apple | Apple å…¨å®¶æ¡¶ |
| â“‚ï¸ Microsoft | Microsoft å…¨å®¶æ¡¶ |
| ğŸ“‹ Google | Google å…¨å®¶æ¡¶ |

æœªè¢«é»˜è®¤åˆ†ç±»çš„åº”ç”¨ï¼Œç”±ç”¨æˆ·å‹¾é€‰æ—¶æ‰‹åŠ¨æŒ‡å®šåˆ†ç»„ã€‚

## æ•°æ®æ¨¡å‹å˜æ›´

### æ–°å¢ç±»å‹ï¼ˆshared/src/types.tsï¼‰

```typescript
// åº”ç”¨è·¯ç”±è§„åˆ™é¡¹ï¼ˆå­˜å‚¨åœ¨ Scheme ä¸­ï¼‰
export interface AppRouteRule {
    appName: string;       // åº”ç”¨åç§°ï¼Œå¯¹åº” blackmatrix7 ä»“åº“ç›®å½•å
    group: string;         // å½’å±çš„ä»£ç†ç»„åç§°ï¼Œå¦‚ "ğŸ¬ æµåª’ä½“"
}

// å¯ç”¨åº”ç”¨åˆ—è¡¨é¡¹ï¼ˆä» GitHub æ‹‰å–ï¼Œç¼“å­˜åœ¨åç«¯ï¼‰
export interface AvailableApp {
    name: string;          // åº”ç”¨åç§°
    defaultGroup?: string; // é»˜è®¤åˆ†ç±»ï¼Œæ— åˆ™ä¸ºç©º
}
```

### AggregateRule æ‰©å±•

```typescript
export interface AggregateRule {
    // ... ç°æœ‰å­—æ®µä¸å˜
    appRules?: AppRouteRule[];  // ç”¨æˆ·å‹¾é€‰çš„åº”ç”¨è·¯ç”±è§„åˆ™
}
```

## åç«¯å˜æ›´

### 1. åº”ç”¨åˆ—è¡¨æœåŠ¡ï¼ˆæ–°å»º `services/appRuleService.ts`ï¼‰

- å¯åŠ¨æ—¶åŠæ¯æ—¥å®šæ—¶ä» GitHub API æ‹‰å– `rule/Clash/` ç›®å½•åˆ—è¡¨
- ç¼“å­˜åˆ° `data/available-apps.json`
- å†…ç½®é»˜è®¤åˆ†ç±»æ˜ å°„è¡¨ï¼ˆå¸¸ç”¨åº”ç”¨ â†’ ä»£ç†ç»„ï¼‰
- æä¾› API è¿”å›å¯ç”¨åº”ç”¨åˆ—è¡¨ï¼ˆå«é»˜è®¤åˆ†ç±»ä¿¡æ¯ï¼‰

### 2. æ–°å¢ APIï¼ˆ`routes/aggregate.ts` ä¸­æ·»åŠ ï¼‰

| æ–¹æ³• | è·¯å¾„ | è¯´æ˜ |
|------|------|------|
| GET | `/api/available-apps` | è·å–å¯ç”¨åº”ç”¨åˆ—è¡¨ï¼ˆå«é»˜è®¤åˆ†ç±»ï¼‰ |
| POST | `/api/available-apps/refresh` | æ‰‹åŠ¨è§¦å‘åˆ·æ–°åº”ç”¨åˆ—è¡¨ |

### 3. èšåˆé…ç½®ç”Ÿæˆå˜æ›´ï¼ˆ`clashService.ts`ï¼‰

åœ¨ `aggregateConfigs()` ç”Ÿæˆé…ç½®æ—¶ï¼š

1. **ç”Ÿæˆ rule-providers**ï¼šä¸ºæ¯ä¸ªå‹¾é€‰çš„åº”ç”¨ç”Ÿæˆ rule-provider æ¡ç›®
   ```yaml
   rule-providers:
     Telegram:
       type: http
       behavior: classical
       url: "https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/rule/Clash/Telegram/Telegram.yaml"
       path: ./ruleset/Telegram.yaml
       interval: 86400
   ```

2. **ç”Ÿæˆä»£ç†ç»„**ï¼šä¸ºæ¯ä¸ªæœ‰åº”ç”¨å¼•ç”¨çš„åˆ†ç±»ç”Ÿæˆ `type: select` ä»£ç†ç»„ï¼Œå¯é€‰é¡¹åŒ…æ‹¬ï¼š
   - `ğŸ”° èŠ‚ç‚¹é€‰æ‹©`
   - `ğŸ¯ å…¨çƒç›´è¿`
   - `â™»ï¸ è‡ªåŠ¨é€‰æ‹©`
   - åœ°åŸŸç»„ï¼ˆè‹¥å¯ç”¨äº† regionGroupingï¼‰

3. **ç”Ÿæˆè§„åˆ™**ï¼šåœ¨åˆå¹¶è§„åˆ™ä¹‹å‰æ’å…¥ RULE-SET è§„åˆ™
   ```yaml
   rules:
     - RULE-SET,Telegram,ğŸ’¬ ç¤¾äº¤é€šè®¯
     - RULE-SET,YouTube,ğŸ¬ æµåª’ä½“
     # ... è®¢é˜…æºåˆå¹¶è§„åˆ™
     - MATCH,DIRECT
   ```

## å‰ç«¯å˜æ›´

### SchemeDetail.vue - èšåˆè®¾ç½® Tab

åœ¨ç°æœ‰çš„ã€Œèšåˆè®¾ç½®ã€åŒºåŸŸä¸‹æ–¹æ–°å¢ã€Œåº”ç”¨è·¯ç”±ã€é…ç½®åŒºï¼š

1. **åº”ç”¨é€‰æ‹©å™¨**
   - æœç´¢æ¡†ï¼šæ”¯æŒæŒ‰åç§°æœç´¢è¿‡æ»¤åº”ç”¨
   - å·²é€‰åº”ç”¨åˆ—è¡¨ï¼šå±•ç¤ºå·²å‹¾é€‰çš„åº”ç”¨åŠå…¶å½’å±åˆ†ç»„
   - æ¯ä¸ªå·²é€‰åº”ç”¨å¯ä¿®æ”¹å½’å±çš„ä»£ç†ç»„ï¼ˆä¸‹æ‹‰é€‰æ‹©ï¼‰
   - æ”¯æŒç§»é™¤å·²é€‰åº”ç”¨

2. **ä»£ç†ç»„ä¸‹æ‹‰é€‰é¡¹**
   - é¢„å®šä¹‰åˆ†ç±»ç»„ï¼ˆğŸ¬ æµåª’ä½“ã€ğŸ’¬ ç¤¾äº¤é€šè®¯ ç­‰ï¼‰
   - ğŸ”° èŠ‚ç‚¹é€‰æ‹©
   - ğŸ¯ å…¨çƒç›´è¿
   - åœ°åŸŸç»„ï¼ˆåŠ¨æ€ï¼Œå–å†³äº regionGrouping æ˜¯å¦å¯ç”¨ï¼‰

### API è°ƒç”¨ï¼ˆapi/index.tsï¼‰

æ–°å¢ï¼š
- `getAvailableApps()` - è·å–å¯ç”¨åº”ç”¨åˆ—è¡¨
- `refreshAvailableApps()` - æ‰‹åŠ¨åˆ·æ–°

åº”ç”¨è·¯ç”±çš„ä¿å­˜å¤ç”¨ç°æœ‰çš„ `updateScheme()` APIï¼ˆé€šè¿‡ `rules.appRules` å­—æ®µï¼‰ã€‚

## é»˜è®¤åˆ†ç±»æ˜ å°„ï¼ˆå¸¸ç”¨åº”ç”¨ï¼‰

ä»¥ä¸‹ä¸ºå†…ç½®çš„é»˜è®¤åˆ†ç±»ï¼Œè¦†ç›–å¸¸ç”¨åº”ç”¨ã€‚å®Œæ•´æ˜ å°„è¡¨ç»´æŠ¤åœ¨åç«¯ `appRuleService.ts` ä¸­ã€‚

### ğŸ¬ æµåª’ä½“
YouTube, Netflix, Disney, DisneyPlus, Spotify, TikTok, Twitch, BiliBili, Hulu, HBO, PrimeVideo, AppleTV, Peacock, Vimeo, Crunchyroll, DAZN, iQIYI, YouKu, MangoTV, AcFun, Niconico, SoundCloud, AppleMusic, YouTubeMusic, Pandora, Tidal

### ğŸ’¬ ç¤¾äº¤é€šè®¯
Telegram, WhatsApp, Discord, Twitter, Facebook, Instagram, Line, Signal, Snapchat, WeChat, QQ, Skype, Messenger, Reddit, Tumblr, Pinterest, LinkedIn, Mastodon, Threads

### ğŸ¤– AI æœåŠ¡
OpenAI, Claude, Gemini, Copilot, Perplexity, Midjourney, HuggingFace, Anthropic, DeepSeek, Poe

### ğŸ® æ¸¸æˆ
Steam, Epic, PlayStation, Xbox, Nintendo, EA, Blizzard, Riot, Roblox, Ubisoft, Origin, GOG, Garena

### ğŸ›  å¼€å‘è€…
GitHub, GitLab, Docker, StackOverflow, NPM, PyPI, JetBrains, DigitalOcean, Cloudflare, Vercel, Heroku, Netlify, AWS

### ğŸ Apple
Apple, iCloud, AppStore, AppleMusic, AppleTV, FaceTime, TestFlight

### â“‚ï¸ Microsoft
Microsoft, OneDrive, Bing, Teams, Office365, Outlook, Azure, Xbox, LinkedIn, VisualStudio

### ğŸ“‹ Google
Google, YouTube, Gmail, GoogleDrive, GooglePlay, GoogleTranslate, GoogleScholar, GoogleAnalytics, Firebase, Android

æ³¨æ„ï¼šéƒ¨åˆ†åº”ç”¨åç§°éœ€è¦ä¸ blackmatrix7 ä»“åº“ä¸­çš„å®é™…ç›®å½•åå¯¹åº”ï¼Œå®æ–½æ—¶éœ€è¦æ ¡éªŒå¹¶è°ƒæ•´ã€‚

## æ³¨æ„äº‹é¡¹

- åº”ç”¨åˆ—è¡¨æ•°æ®è·¨æ–¹æ¡ˆå…±äº«ï¼Œç¼“å­˜åœ¨åç«¯å…¨å±€ï¼Œä¸å±äºæŸä¸ª Scheme
- æ¯ä¸ª Scheme çš„ `appRules` ç‹¬ç«‹å­˜å‚¨ç”¨æˆ·å‹¾é€‰çš„åº”ç”¨åŠåˆ†ç»„
- åªæœ‰å®é™…è¢«å¼•ç”¨åˆ°çš„ä»£ç†ç»„åˆ†ç±»æ‰ä¼šå‡ºç°åœ¨ç”Ÿæˆçš„é…ç½®ä¸­ï¼ˆå¦‚æœæ²¡æœ‰ä»»ä½•åº”ç”¨å½’å±"ğŸ® æ¸¸æˆ"ï¼Œåˆ™ä¸ç”Ÿæˆè¯¥ä»£ç†ç»„ï¼‰
- ä»£ç†ç»„åˆ†ç±»æ’å…¥ä½ç½®ï¼šåœ¨ `ğŸ”° èŠ‚ç‚¹é€‰æ‹©` å’Œ `â™»ï¸ è‡ªåŠ¨é€‰æ‹©` ä¹‹åï¼Œåœ¨ `ğŸ¯ å…¨çƒç›´è¿` å’Œ `ğŸ›‘ å…¨çƒæ‹¦æˆª` ä¹‹å‰
